
@{
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
}

@model List<LW_Data.clsADPRecord>


<!-- Start Content-->
<div class="container-fluid">

    <div class="row">

        <!-- WO ANALYSIS REPORT -->
        <div class="col-12">

            <div class="card">
                <div class="card-body">
                    <h4 class="header-title">Edit ADP Record</h4>

                    <table border="1">
                        <thead>
                            <tr>
                                <th>Company Code</th>
                                <th>Laborer ID</th>
                                <th>Payroll Name</th>
                                <th>File Number</th>
                                <th>Time In</th>
                                <th>Time Out</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var record in Model)
                            {
                                <tr data-id="@record.ADPRowID">
                                    <td><input type="text" value="@record.CompanyCode" class="company-code" /></td>
                                    <td><input type="text" value="@record.LaborerID" class="laborer-id" /></td>
                                    <td><input type="text" value="@record.PayrollName" class="payroll-name" /></td>
                                    <td><input type="text" value="@record.FileNumber" class="file-number" /></td>
                                    <td><input type="datetime-local" value="@record.TimeIn?.ToString(" yyyy-MM-ddTHH:mm")" class="time-in" /></td>
                                    <td><input type="datetime-local" value="@record.TimeOut?.ToString(" yyyy-MM-ddTHH:mm")" class="time-out" /></td>
                                    <td><button class="save">Save</button></td>
                                </tr>
                            }
                        </tbody>
                    </table>

                </div> <!-- end card-body -->
            </div>  <!-- end card -->

        </div>
        <!-- end col -->


    </div>
</div>

    <script>
        $(document).ready(function () {
            $('.save').click(function () {
                var row = $(this).closest('tr');
                var id = row.data('id');
                var companyCode = row.find('.company-code').val();
                var laborerId = row.find('.laborer-id').val();
                var payrollName = row.find('.payroll-name').val();
                var fileNumber = row.find('.file-number').val();
                var timeIn = row.find('.time-in').val();
                var timeOut = row.find('.time-out').val();

                $.ajax({
                    url: '/ADP/Update',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        ADPRowID: id,
                        CompanyCode: companyCode,
                        LaborerID: laborerId,
                        PayrollName: payrollName,
                        FileNumber: fileNumber,
                        TimeIn: timeIn,
                        TimeOut: timeOut
                    }),
                    success: function (data) {
                        alert('Update successful!');
                    },
                    error: function () {
                        alert('Update failed!');
                    }
                });
            });
        });
    </script>






